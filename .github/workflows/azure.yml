on:
  workflow_dispatch:

name: Deploy Infrastructure with ARM Demo

jobs:
  deploy-arm-template:
    runs-on: ubuntu-latest
    environment: sandbox3
    
    steps:
    - name: Check out the repo
      uses: actions/checkout@v2
    
    - name: Login to Azure
      uses: azure/login@v1
      with:
        creds: ${{ secrets.AZURE_CREDS }}
    
    - run: |
        az deployment sub create --subscription ${{secrets.AZURE_CREDS}} --name github-deploy --location eastus2 --template-file ./iacdemo2-deploy.json --parameters ./iacdemo2-deploy.parameters.json
